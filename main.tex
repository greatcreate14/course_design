%!TEX program = xelatex
\documentclass[a4paper, twoside]{ctexart} 

% ==================== 导言区设置 ====================
\usepackage[top=2.5cm, bottom=2.5cm, inner=3cm, outer=2.5cm]{geometry} 
\usepackage{fontspec} 
\usepackage{xeCJK} 
\usepackage{amsmath, amssymb, amsthm} 
\usepackage{graphicx} 
\usepackage{booktabs} 
\usepackage{multirow} 
\usepackage{indentfirst} 
\usepackage{listings} 
\usepackage{xcolor} 
\usepackage{fancyhdr}
\usepackage{pdfpages} % <--- 新增：用于插入PDF封面
\usepackage{enumitem} % 用于自定义列表样式
\usepackage{pifont}
\usepackage{booktabs} % 用于绘制专业的三线表
\usepackage{array}    % 更好的列控制

% 参考文献使用 BibTeX + natbib 宏包
% 顺序编码制
\usepackage[numbers, sort&compress]{natbib}
\bibliographystyle{plain}

\usepackage{hyperref} %超链接

\makeatletter
\def\input@path{{scr/}} % 这里的 scr/ 是你的文件夹名称
\makeatother

\graphicspath{{figures/}}

% 设置超链接颜色
\hypersetup{
    colorlinks=true,
    linkcolor=black,
    citecolor=black
}

\setlength{\headheight}{12.64723pt}

% 设置章节标题格式
\ctexset{
  section={
    format=\Large\bfseries\centering,
    nameformat=\bfseries,
    number=\chinese{section},
    aftername={、},
    beforeskip=1.5ex plus 0.2ex minus 0.2ex,
    afterskip=1ex plus 0.1ex
  },
  subsection={
    format=\large\bfseries,
    nameformat=\bfseries,
    number=\arabic{section}.\arabic{subsection},
    aftername={\quad},
    beforeskip=1.2ex plus 0.1ex minus 0.1ex,
    afterskip=0.8ex plus 0.1ex
  },
  subsubsection={
    number=\arabic{subsubsection},
    aftername={. }
  }
}

% 定理环境设置
\newtheorem{theorem}{定理}[section]
\newtheorem{lemma}[theorem]{引理}
\newtheorem{definition}[theorem]{定义}
\newtheorem{example}[theorem]{例}

% 代码样式设置
\lstset{
  basicstyle=\small\ttfamily,
  keywordstyle=\bfseries, 
  commentstyle=\itshape, 
  frame=none, 
  numbers=none 
}

% 页眉页脚设置
\pagestyle{fancy}
\fancyhf{}
% RO: 奇数页右侧，LE: 偶数页左侧（即外侧打印页码）
\fancyhead[RO, LE]{\thepage}
% LO: 奇数页左侧，RE: 偶数页右侧（即内侧打印章节名）
\fancyhead[LO, RE]{\leftmark}

\renewcommand{\headrulewidth}{0.4pt}
\fancyfoot[C]{}

% 使自动插入的空白页不显示页眉页脚
\makeatletter
\def\cleardoublepage{\clearpage\if@twoside \ifodd\c@page\else
  \hbox{}\thispagestyle{empty}\newpage\if@twocolumn\hbox{}\newpage\fi\fi\fi}
\makeatother

% --- 图表按章节编号设置 ---
% 使用 amsmath 提供的命令将图表编号与 section 绑定
\numberwithin{figure}{section}
\numberwithin{table}{section}

% 如果你希望即使 section 使用中文数字（如“第一页”），图表依然显示阿拉伯数字（如“图1.1”）
% 请取消下面两行的注释并使用它们：
 \renewcommand{\thefigure}{\arabic{section}.\arabic{figure}}
 \renewcommand{\thetable}{\arabic{section}.\arabic{table}}

% 自定义命令
\input{newcommand}

% ==================== 正文区域 ====================
\begin{document}

% 1. 插入封面 PDF (假设文件名为 cover.pdf)
% pages=1 表示只取第一页，如果是多页封面可以用 pages=-
\includepdf[pages=1]{课设说明.pdf} 
\cleardoublepage %封面单独打印
\includepdf[pages=2]{课设说明.pdf} 
\cleardoublepage  %课设任务页单独打印

% 2. 生成目录
\pagenumbering{gobble}
\tableofcontents
\cleardoublepage %确保正文从奇数页开始

% 3. 导入各个部分

\pagenumbering{arabic}

% 导入各章节
\input{chapter1} 
\newpage
\input{chapter2} 
\newpage

% 参考文献
\addcontentsline{toc}{section}{参考文献} % 将参考文献加入目录
\nocite{*} % .bib 文件里的所有条目都会出现在列表里
\bibliography{ref/refs}  % 参考文献使用 BibTeX 编译

%最后一章不用\newpage
\cleardoublepage %确保成绩评定表从奇数页开始
\includepdf[pages=3]{课设说明.pdf} 

\end{document}